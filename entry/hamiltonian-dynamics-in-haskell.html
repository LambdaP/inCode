<!DOCTYPE HTML>
<html><head><title>Hamiltonian Dynamics in Haskell · in Code</title><meta name="description" content="Weblog of Justin Le, covering his various adventures in programming and explorations in the vast worlds of computation physics, and knowledge."><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><meta property="og:site_name" content="in Code"><meta property="og:description" content="As promised in my hamilton introduction post, I’m going to go over implementing of the hamilton library using ad and dependent types. This post will be a bit heavy in some mathematics and Haskell concepts. The expected audience is intermediate Haskell programmers, and no previous knowledge of dependent types is expected. The mathematics and physics are extra flavor text and could potentially be skipped, but you’ll get the most out of this article if you have basic familiarity with:  * Basic concepts of multivariable calculus (like partial and total derivatives). * Concepts of linear algebra (like dot products, matrix multiplication, and matrix inverses) No physics knowledge is assumed, but knowing a little bit of first semester physics would help you gain a bit more of an appreciation for the end result!"><meta property="og:type" content="article"><meta property="og:title" content="Hamiltonian Dynamics in Haskell"><meta property="og:image" content="https://blog.jle.im/img/site_logo.jpg"><meta property="og:locale" content="en_US"><meta property="og:url" content="https://blog.jle.im/entry/hamiltonian-dynamics-in-haskell.html"><meta name="twitter:card" content="summary"><meta name="twitter:creator:id" content="mstk"><link rel="author" href="https://plus.google.com/107705320197444500140"><link rel="alternate" type="application/rss+xml" title="in Code (RSS Feed)" href="http://feeds.feedburner.com/incodeblog"><link rel="canonical" href="https://blog.jle.im/entry/hamiltonian-dynamics-in-haskell.html"><link href="https://blog.jle.im/favicon.ico" rel="shortcut icon"><link href="https://blog.jle.im/css/toast.css" rel="stylesheet" type="text/css"><link href="https://blog.jle.im/css/font.css" rel="stylesheet" type="text/css"><link href="https://blog.jle.im/css/main.css" rel="stylesheet" type="text/css"><link href="https://blog.jle.im/css/page/entry.css" rel="stylesheet" type="text/css"><link href="https://blog.jle.im/css/pygments.css" rel="stylesheet" type="text/css"><script type="text/javascript">var page_data = {};
var disqus_shortname='incode';
</script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-443711-8', 'jle.im');
ga('send', 'pageview');
</script><script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script><script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5234d67a6b68dcd4"></script><script type="text/javascript" src="https://blog.jle.im/js/page/entry_toc.js"></script><script type="text/javascript" src="https://blog.jle.im/js/disqus_count.js"></script><script type="text/javascript" src="https://blog.jle.im/js/social.js"></script><script type="text/javascript" src="https://blog.jle.im/js/jquery/jquery.toc.js"></script><script type="text/javascript" src="https://blog.jle.im/purescript/entry.js"></script></head><body><div id="fb-root"><script>(function(d, s, id) {
 var js, fjs = d.getElementsByTagName(s)[0];
 if (d.getElementById(id)) return;
 js = d.createElement(s); js.id = id;
 js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=641852699171929";
 fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));
</script></div><div id="header-container"><div id="navbar-container" class="tile"><nav id="navbar-content"><div class="nav-info"><h1 class="site-title"><a href="https://blog.jle.im/" class="nav-title">in Code</a></h1><span class="nav-author">Justin Le</span></div><ul class="nav-links"><li><a href="https://blog.jle.im/">home</a></li><li><a href="https://blog.jle.im/entries.html">archives</a></li><div class="clear"></div></ul></nav></div><div id="header-content"></div></div><div id="body-container" class="container"><div id="main-container" class="grid"><div class="entry-section unit span-grid" role="main"><article class="tile article"><header><div class="unposted-banner">Unposted entry</div><h1 id="title">Hamiltonian Dynamics in Haskell</h1><p class="entry-info">by <a class="author" href="https://blog.jle.im/">Justin Le</a></p><p><span class="source-info"><a class="source-link" href="https://github.com/mstksg/inCode/tree/master/copy/entries/hamilton-1.md">Source</a><span class="info-separator"> &diams; </span><a class="source-link" href="https://github.com/mstksg/inCode/tree/gh-pages/entry/hamiltonian-dynamics-in-haskell.md">Markdown</a><span class="info-separator"> &diams; </span><a class="source-link" href="https://blog.jle.im/entry/hamiltonian-dynamics-in-haskell.tex">LaTeX</a><span class="info-separator"> &diams; </span></span>Posted in <a href="https://blog.jle.im/entries/category/@haskell.html" class="tag-a-category" title="Functional, pure, non-strict, statically and strongly typed, natively
compiled…really just the king of great languages.">Haskell</a><span class="info-separator"> &diams; </span><a class="comment-link" href="#disqus_thread">Comments</a></p></header><hr><aside class="contents-container"><h5 id="contents-header">Contents</h5><div id="toc"></div></aside><div class="main-content copy-content"><p>As promised in my <a href="https://blog.jle.im/entry/introducing-the-hamilton-library.html"><em>hamilton</em> introduction post</a>, I’m going to go over implementing of the <em><a href="http://hackage.haskell.org/package/hamilton">hamilton</a></em> library using <em><a href="http://hackage.haskell.org/package/ad">ad</a></em> and dependent types.</p>
<p>This post will be a bit heavy in some mathematics and Haskell concepts. The expected audience is intermediate Haskell programmers, and no previous knowledge of dependent types is expected.</p>
<p>The mathematics and physics are “extra” flavor text and could potentially be skipped, but you’ll get the most out of this article if you have basic familiarity with:</p>
<ol type="1">
<li>Basic concepts of multivariable calculus (like partial and total derivatives).</li>
<li>Concepts of linear algebra (like dot products, matrix multiplication, and matrix inverses)</li>
</ol>
<p>No physics knowledge is assumed, but knowing a little bit of first semester physics would help you gain a bit more of an appreciation for the end result!</p>
<h2 id="hamiltonian-mechanics">Hamiltonian Mechanics</h2>
<p>As mentioned in the previous post, Hamiltonian mechanics is a re-imagining of dynamics and mechanics (think “the world post-<img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?F%20%3D%20m%20a" alt="F = m a" title="F = m a" />”) that not only opened up new doors to solving problems in classical, but also ended up being the right angle of viewing the world to unlock statistical mechanics and thermodynamics, and later even quantum mechanics.</p>
<p>Hamiltonian mechanics lets you parameterize your system’s “position” in arbitrary ways (like the angle of rotation, for pendulum problems) and then posits that the full state of the system exists in something called <em>phase space</em>, and that the system’s dynamics is its motion through phase space that is dictated by the geometry of the <em>Hamiltonian</em> of that phase space.</p>
<p>The system’s <em>Hamiltonian</em> is a <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cmathbb%7BR%7D%5E%7B2n%7D%20%5Crightarrow%20%5Cmathbb%7BR%7D" alt="\mathbb{R}^{2n} \rightarrow \mathbb{R}" title="\mathbb{R}^{2n} \rightarrow \mathbb{R}" /> function on phase space (where <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?n" alt="n" title="n" /> is the number of coordinates parameterizing your system) to <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cmathbb%7BR%7D" alt="\mathbb{R}" title="\mathbb{R}" />. For a time-independent system, the picture of the dynamics is pretty simple: the system moves along the <em>contour lines</em> of the <em>Hamiltonian</em> – the lines of equal “height”.</p>
<figure>
<img src="/img/entries/hamilton/contour-lines.jpg" title="Contour lines" alt="Example of contour lines of a \mathbb{R}^2 \rightarrow \mathbb{R} function – the elevation of land. From the Ordinace Survey website." /><figcaption>Example of contour lines of a <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cmathbb%7BR%7D%5E2%20%5Crightarrow%20%5Cmathbb%7BR%7D" alt="\mathbb{R}^2 \rightarrow \mathbb{R}" title="\mathbb{R}^2 \rightarrow \mathbb{R}" /> function – the elevation of land. From the <a href="https://www.ordnancesurvey.co.uk/blog/2015/11/map-reading-skills-making-sense-of-contour-lines/">Ordinace Survey</a> website.</figcaption>
</figure>
<p>In the example above, if we imagine that phase space is the 2D location, then the <em>Hamiltonian</em> is the mountain. And for a system dropped anywhere on the mountain, its motion would be along the contour lines. For example, if a system started somewhere along the 10 contour line, it would begin to oscillate the entire phase space along the 10 contour line.<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a></p>
<p><em>Every</em> <a href="https://en.wikipedia.org/wiki/Smooth_jazz">smooth</a> <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cmathbb%7BR%7D%5E%7B2n%7D%20%5Crightarrow%20%5Cmathbb%7BR%7D" alt="\mathbb{R}^{2n} \rightarrow \mathbb{R}" title="\mathbb{R}^{2n} \rightarrow \mathbb{R}" /> function on phase space can be used as a Hamiltonian to describe the physics of some system. So, given any “mountain range” on phase space, any “elevation map” or real-valued function on phase space, you can treat it as a description of the dynamics of some physical system.</p>
<p>The <em>trick</em>, then, to using Hamiltonian dynamics to model your system, is:</p>
<ol type="1">
<li><p>Finding the phase space to describe your system. This can be done based on any continuous parameterization of your system (“generalized coordinates”), like angles of pendulums and so on.</p></li>
<li><p>Finding the Hamiltonian on that phase space to describe your system.</p></li>
</ol>
<p>And then Hamilton’s dynamics will give you the rest! All you do is “follow the contour lines” on that Hamiltonian!</p>
<h3 id="phase-space">Phase Space</h3>
<p>So far the only thing I’ve really said in detail is that if your system’s state has <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?n" alt="n" title="n" /> parameters, then the corresponding phase space is <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?2n" alt="2n" title="2n" />-dimensional (and that Hamiltonian mechanics is somehow about systems moving around in phase space). <em>Phase space</em> is a <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?2n" alt="2n" title="2n" />-dimensional space parameterized by:</p>
<ol type="1">
<li>All of the current values of the <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?n" alt="n" title="n" /> parameters (“generalized coordinates”)</li>
<li>All of the current “generalized momenta” of those <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?n" alt="n" title="n" /> parameters</li>
</ol>
<p>So if you were parameterizing your pendulum system by, say, the angle of the pendulum, the phase space would be the current angle of the pendulum along with the current “generalized momentum” associated with the angle of the pendulum. What exactly <em>is</em> generalized momentum? We’ll go over calculating it eventually, but what does it represent…<em>physically</em>?</p>
<p>I could give you some spiel here about the underlying Lie algebra of the Lie group associated with the generalized coordinates, but I don’t think that it would be very intuitively appealing in a physical sense. But what I <em>can</em> say is that the generalized momenta associated with (“conjugate to”) certain sets of familiar coordinates yield things that we typically call “momenta”:</p>
<ol type="1">
<li><p>The momentum conjugate to normal Cartesian coordinates is just our normal run-of-the-mill <em>linear momentum</em> (in the <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cmathbf%7Bp%7D%20%3D%20m%20%5Cmathbf%7Bv%7D" alt="\mathbf{p} = m \mathbf{v}" title="\mathbf{p} = m \mathbf{v}" />) from first semester physics.</p></li>
<li><p>The momentum conjugate to the angle <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Ctheta" alt="\theta" title="\theta" /> in polar coordinates is <em>angular momentum</em> (<img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cmathbf%7BL%7D%20%3D%20m%20%5Cmathbf%7Br%7D%20%5Ctimes%20%5Cmathbf%7Bv%7D" alt="\mathbf{L} = m \mathbf{r} \times \mathbf{v}" title="\mathbf{L} = m \mathbf{r} \times \mathbf{v}" />, or <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?L%20%3D%20m%20r%5E2%20%5Cdot%7B%5Ctheta%7D" alt="L = m r^2 \dot{\theta}" title="L = m r^2 \dot{\theta}" />) from first semester physics.</p>
<p>The momentum conjugate to the radial coordinate <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?r" alt="r" title="r" /> in polar coordinates is also just boring old linear momentum <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?p_r%20%3D%20m%20%5Cdot%7Br%7D" alt="p_r = m \dot{r}" title="p_r = m \dot{r}" />.</p></li>
</ol>
<p>So, it’s our normal momentum (for linear and polar coordinates) <em>generalized</em> to arbitrary coordinates.</p>
<h3 id="hamiltonian-dynamics">Hamiltonian Dynamics</h3>
<p>I’ve explained Hamiltonian dynamics for time-independent Hamiltonians as “follow the contour lines”. If you remember your basic multi-variable calculus course, you’ll know that the line of “steepest ascent” is the gradient. If we call the Hamiltonian <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cmathcal%7BH%7D%28%5Cmathbf%7Bq%7D%2C%5Cmathbf%7Bp%7D%29" alt="\mathcal{H}(\mathbf{q},\mathbf{p})" title="\mathcal{H}(\mathbf{q},\mathbf{p})" /> (where <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cmathbf%7Bq%7D" alt="\mathbf{q}" title="\mathbf{q}" /> is the vector of positions and <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cmathbf%7Bp%7D" alt="\mathbf{p}" title="\mathbf{p}" /> is the vector of momenta), then the direction of steepest ascent is <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cleft%20%5Clangle%20%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20%5Cmathbf%7Bq%7D%7D%20%5Cmathcal%7BH%7D%28%5Cmathbf%7Bq%7D%2C%5Cmathbf%7Bp%7D%29%2C%20%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20%5Cmathbf%7Bp%7D%7D%20%5Cmathcal%7BH%7D%28%5Cmathbf%7Bq%7D%2C%5Cmathbf%7Bp%7D%29%20%5Cright%20%5Crangle" alt="\left \langle \frac{\partial}{\partial \mathbf{q}} \mathcal{H}(\mathbf{q},\mathbf{p}), \frac{\partial}{\partial \mathbf{p}} \mathcal{H}(\mathbf{q},\mathbf{p}) \right \rangle" title="\left \langle \frac{\partial}{\partial \mathbf{q}} \mathcal{H}(\mathbf{q},\mathbf{p}), \frac{\partial}{\partial \mathbf{p}} \mathcal{H}(\mathbf{q},\mathbf{p}) \right \rangle" />.</p>
<p>But we want to move along the <em>contour lines</em>…and these are the lines <em>perpendicular</em> to the direction of steepest descent. The vector perpendicular to <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Clangle%20x%2C%20y%20%5Crangle" alt="\langle x, y \rangle" title="\langle x, y \rangle" /> is <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Clangle%20y%2C%20-x%20%5Crangle" alt="\langle y, -x \rangle" title="\langle y, -x \rangle" />, so we just derived the actual Hamiltonian equations of motion: just move in the direction perpendicular to the steepest descent!</p>
<p><br /><img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%0A%5Cdot%7Bq%7D%20%3D%20%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20p_q%7D%20%5Cmathcal%7BH%7D%28%5Cmathbf%7Bq%7D%2C%5Cmathbf%7Bp%7D%29%0A" alt="
\dot{q} = \frac{\partial}{\partial p_q} \mathcal{H}(\mathbf{q},\mathbf{p})
" title="
\dot{q} = \frac{\partial}{\partial p_q} \mathcal{H}(\mathbf{q},\mathbf{p})
" /><br /></p>
<p><br /><img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%0A%5Cdot%7Bp_q%7D%20%3D%20-%20%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20q%7D%20%5Cmathcal%7BH%7D%28%5Cmathbf%7Bq%7D%2C%5Cmathbf%7Bp%7D%29%0A" alt="
\dot{p_q} = - \frac{\partial}{\partial q} \mathcal{H}(\mathbf{q},\mathbf{p})
" title="
\dot{p_q} = - \frac{\partial}{\partial q} \mathcal{H}(\mathbf{q},\mathbf{p})
" /><br /></p>
<p>Which holds for every generalized coordinate <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?q" alt="q" title="q" />, where <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?p_q" alt="p_q" title="p_q" /> is the momentum conjugate to that coordinate.</p>
<p>Essentially, these give you “updating functions” for <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?q" alt="q" title="q" /> and <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?p_q" alt="p_q" title="p_q" /> – given <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cmathcal%7BH%7D%28%5Cmathbf%7Bq%7D%2C%5Cmathbf%7Bp%7D%29" alt="\mathcal{H}(\mathbf{q},\mathbf{p})" title="\mathcal{H}(\mathbf{q},\mathbf{p})" />, you have a way to “update” the particle’s position in phase space. Just take the partial derivatives of <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cmathcal%7BH%7D" alt="\mathcal{H}" title="\mathcal{H}" /> at every step in time! To update <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?q" alt="q" title="q" />, nudge it by <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20p_q%7D%20%5Cmathcal%7BH%7D%28%5Cmathbf%7Bq%7D%2C%5Cmathbf%7Bp%7D%29" alt="\frac{\partial}{\partial p_q} \mathcal{H}(\mathbf{q},\mathbf{p})" title="\frac{\partial}{\partial p_q} \mathcal{H}(\mathbf{q},\mathbf{p})" />. To update <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?p_q" alt="p_q" title="p_q" />, nudge it by <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20q%7D%20%5Cmathcal%7BH%7D%28%5Cmathbf%7Bq%7D%2C%5Cmathbf%7Bp%7D%29" alt="\frac{\partial}{\partial q} \mathcal{H}(\mathbf{q},\mathbf{p})" title="\frac{\partial}{\partial q} \mathcal{H}(\mathbf{q},\mathbf{p})" />!</p>
<p>This picture is appealing to me in a visceral way because it sort of seems like the system is “surfing” along the Hamiltonian’s contour lines. It’s being “pushed” <em>faster</em> when the Hamiltonian is steeper, and slower when it’s more shallow. I can apply all my intuition as a surfer<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a> to Hamiltonian mechanics!</p>
<h2 id="hamiltonian-dynamics-and-physical-systems">Hamiltonian Dynamics and Physical Systems</h2>
<p>Earlier I mentioned that the two steps for applying Hamiltonian mechanics to your system was figuring out your system’s conjugate momenta and the appropriate Hamiltonian. Let’s get onto that. I’m going to make a couple of simplifying assumptions that make the job easier for the purposes of this article:</p>
<ol type="1">
<li>Your coordinates and potential energy are time-independent.</li>
<li>Your potential energy function only depends on <em>positions</em>, and not <em>velocities</em>. (So nothing like friction or wind resistance or magnetic field vector potentials)</li>
</ol>
<p>With these assumptions, I’m going to skip over discussing the <a href="https://en.wikipedia.org/wiki/Lagrangian_mechanics">Lagrangian</a> of the system, which is the traditional way to do this. You can think of this section as me presenting derived conclusions and skipping the derivations.</p>
<h3 id="conjugate-momenta">Conjugate Momenta</h3>
<p>It can be shown that the momentum conjugate to coordinate <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?q" alt="q" title="q" /> as</p>
<p><br /><img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%0A%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20%5Cdot%7Bq%7D%7D%20KE%28%5Cmathbf%7Bq%7D%2C%20%5Cdot%7B%5Cmathbf%7Bq%7D%7D%29%0A" alt="
\frac{\partial}{\partial \dot{q}} KE(\mathbf{q}, \dot{\mathbf{q}})
" title="
\frac{\partial}{\partial \dot{q}} KE(\mathbf{q}, \dot{\mathbf{q}})
" /><br /></p>
<p>Where <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?KE%28%5Cdot%7B%5Cmathbf%7Bq%7D%7D%29" alt="KE(\dot{\mathbf{q}})" title="KE(\dot{\mathbf{q}})" /> is the kinetic energy of the system, which is a function on the coordinates <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cmathbf%7Bq%7D" alt="\mathbf{q}" title="\mathbf{q}" /> and their rates of change, <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cdot%7B%5Cmathbf%7Bq%7D%7D" alt="\dot{\mathbf{q}}" title="\dot{\mathbf{q}}" />. For example, for normal Cartesian coordinates in one dimension, <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?KE%28x%2C%20%5Cdot%7Bx%7D%29%20%3D%20%5Cfrac%7B1%7D%7B2%7D%20m%20%5Cdot%7Bx%7D%5E2" alt="KE(x, \dot{x}) = \frac{1}{2} m \dot{x}^2" title="KE(x, \dot{x}) = \frac{1}{2} m \dot{x}^2" />. So the momentum conjugate to <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?x" alt="x" title="x" /> is:</p>
<p><br /><img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%0Ap_x%20%3D%20%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20%5Cdot%7Bx%7D%7D%20%5Cleft%5B%20%5Cfrac%7B1%7D%7B2%7D%20m%20%5Cdot%7Bx%7D%5E2%20%5Cright%5D%20%3D%20m%20%5Cdot%7Bx%7D%0A" alt="
p_x = \frac{\partial}{\partial \dot{x}} \left[ \frac{1}{2} m \dot{x}^2 \right] = m \dot{x}
" title="
p_x = \frac{\partial}{\partial \dot{x}} \left[ \frac{1}{2} m \dot{x}^2 \right] = m \dot{x}
" /><br /></p>
<p>Just linear momentum, like I claimed before!</p>
<p>Alright, now let’s generalize this to arbitrary coordinates. In general, for <em>Cartesian</em> coordinates, the kinetic energy will always be</p>
<p><br /><img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%0AKE%28%5Cmathbf%7Bx%7D%2C%20%5Cdot%7B%5Cmathbf%7Bx%7D%7D%29%20%3D%20%5Cfrac%7B1%7D%7B2%7D%20%5Cleft%5B%20m_1%20%5Cdot%7Bx%7D_1%5E2%20%2B%20m_2%20%5Cdot%7Bx%7D_2%5E2%20%2B%20m_3%20%5Cdot%7Bx%7D_3%5E2%20%2B%20%5Cdots%20%5Cright%5D%0A" alt="
KE(\mathbf{x}, \dot{\mathbf{x}}) = \frac{1}{2} \left[ m_1 \dot{x}_1^2 + m_2 \dot{x}_2^2 + m_3 \dot{x}_3^2 + \dots \right]
" title="
KE(\mathbf{x}, \dot{\mathbf{x}}) = \frac{1}{2} \left[ m_1 \dot{x}_1^2 + m_2 \dot{x}_2^2 + m_3 \dot{x}_3^2 + \dots \right]
" /><br /></p>
<p>Where <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?m" alt="m" title="m" /> is the inertia associated with each coordinate…for example, if <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Clangle%20x_1%2C%20x_2%20%5Crangle" alt="\langle x_1, x_2 \rangle" title="\langle x_1, x_2 \rangle" /> describes the location of an object of mass <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?m" alt="m" title="m" />, then <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?m_1%20%3D%20m_2%20%3D%20m" alt="m_1 = m_2 = m" title="m_1 = m_2 = m" />.</p>
<p>To make things more convenient, we’ll treat this as a quadratic form over an inertia matrix:</p>
<p><br /><img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%0AKE%28%5Cdot%7B%5Cmathbf%7Bx%7D%7D%29%20%3D%20%5Cfrac%7B1%7D%7B2%7D%20%5Cdot%7B%5Cmathbf%7Bx%7D%5ET%7D%20%5Chat%7BM%7D%20%5Cdot%7B%5Cmathbf%7Bx%7D%7D%0A" alt="
KE(\dot{\mathbf{x}}) = \frac{1}{2} \dot{\mathbf{x}^T} \hat{M} \dot{\mathbf{x}}
" title="
KE(\dot{\mathbf{x}}) = \frac{1}{2} \dot{\mathbf{x}^T} \hat{M} \dot{\mathbf{x}}
" /><br /></p>
<p>Where <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Chat%7BM%7D" alt="\hat{M}" title="\hat{M}" /> is the <a href="https://en.wikipedia.org/wiki/Diagonal_matrix">diagonal matrix</a> whose entries are the masses of each coordinate, and <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cdot%7B%5Cmathbf%7Bx%7D%7D" alt="\dot{\mathbf{x}}" title="\dot{\mathbf{x}}" /> is the column vector of all of the (Cartesian) coordinates, <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cleft%5B%20%5Cdot%7Bx_1%7D%20%5Cdot%7Bx_2%7D%20%5Cdot%7Bx_3%7D%20%5Cdots%20%5Cright%5D%5ET" alt="\left[ \dot{x_1} \dot{x_2} \dot{x_3} \dots \right]^T" title="\left[ \dot{x_1} \dot{x_2} \dot{x_3} \dots \right]^T" />.</p>
<p>Now! How to generalize this to arbitrary coordinates? Well, if we have <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?n" alt="n" title="n" /> generalized coordinates <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cmathbf%7Bq%7D" alt="\mathbf{q}" title="\mathbf{q}" /> mapping to <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?m" alt="m" title="m" />-dimensional Cartesian coordinates, we can specify them as <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cmathbf%7Bx%7D%20%3D%20f%28%5Cmathbf%7Bq%7D%29" alt="\mathbf{x} = f(\mathbf{q})" title="\mathbf{x} = f(\mathbf{q})" />, where <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?f%20%3A%20n%20%5Crightarrow%20m" alt="f : n \rightarrow m" title="f : n \rightarrow m" />, taking the vector of generalized coordinates and returning a vector for the position in Cartesian space. For example, for polar coordinates, <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?f%28r%2C%20%5Ctheta%29%20%3D%20%5Cleft%20%5Clangle%20r%20%5Ccos%28%5Ctheta%29%2C%20r%20%5Csin%28%5Ctheta%29%20%5Cright%20%5Crangle" alt="f(r, \theta) = \left \langle r \cos(\theta), r \sin(\theta) \right \rangle" title="f(r, \theta) = \left \langle r \cos(\theta), r \sin(\theta) \right \rangle" />.</p>
<p>So we can get <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cmathbf%7Bx%7D" alt="\mathbf{x}" title="\mathbf{x}" /> from <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cmathbf%7Bq%7D" alt="\mathbf{q}" title="\mathbf{q}" /> with <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?f" alt="f" title="f" />, but how can we get <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cdot%7B%5Cmathbf%7Bx%7D%7D" alt="\dot{\mathbf{x}}" title="\dot{\mathbf{x}}" />, the vector of rate of changes? Well, if <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?x_1%20%3D%20f_1%28q_1%2C%20q_2%20%5Cdots%29" alt="x_1 = f_1(q_1, q_2 \dots)" title="x_1 = f_1(q_1, q_2 \dots)" />, then the <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cdot%7Bx_1%7D" alt="\dot{x_1}" title="\dot{x_1}" /> is the <a href="https://en.wikipedia.org/wiki/Total_derivative">total derivative</a> of <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?x_1" alt="x_1" title="x_1" /> with respect to time:</p>
<p><br /><img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%0A%5Cdot%7Bx_1%7D%20%3D%20%5Cfrac%7B%5Cpartial%20f_1%7D%7B%5Cpartial%20q_1%7D%20%5Cdot%7Bq_1%7D%20%2B%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20f_1%7D%7B%5Cpartial%20q_2%7D%20%5Cdot%7Bq_2%7D%20%2B%20%5Cdots%0A" alt="
\dot{x_1} = \frac{\partial f_1}{\partial q_1} \dot{q_1} +
    \frac{\partial f_1}{\partial q_2} \dot{q_2} + \dots
" title="
\dot{x_1} = \frac{\partial f_1}{\partial q_1} \dot{q_1} +
    \frac{\partial f_1}{\partial q_2} \dot{q_2} + \dots
" /><br /></p>
<p>Or, in short:</p>
<p><br /><img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%0A%5Cdot%7Bx_i%7D%20%3D%20%5Csum_%7Bj%20%3D%201%7D%5En%20%5Cfrac%7B%5Cpartial%20f_i%7D%7B%5Cpartial%20q_j%7D%20%5Cdot%7Bq_j%7D%0A" alt="
\dot{x_i} = \sum_{j = 1}^n \frac{\partial f_i}{\partial q_j} \dot{q_j}
" title="
\dot{x_i} = \sum_{j = 1}^n \frac{\partial f_i}{\partial q_j} \dot{q_j}
" /><br /></p>
<p>But, hey, this looks a lot like a matrix multiplication. If we call <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Chat%7BJ%7D_f" alt="\hat{J}_f" title="\hat{J}_f" /> the <a href="https://en.wikipedia.org/wiki/Jacobian_matrix_and_determinant">Jacobian matrix</a>, the <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?m%20%5Ctimes%20n" alt="m \times n" title="m \times n" /> matrix of partial derivatives of <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?f" alt="f" title="f" /> (<img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Chat%7BJ%7D_%7Bfij%7D%20%3D%20%5Cfrac%7B%5Cpartial%20f_i%7D%7B%5Cpartial%20q_j%7D" alt="\hat{J}_{fij} = \frac{\partial f_i}{\partial q_j}" title="\hat{J}_{fij} = \frac{\partial f_i}{\partial q_j}" />) at a given point, then we have a nice expression for <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cdot%7B%5Cmathbf%7Bx%7D%7D" alt="\dot{\mathbf{x}}" title="\dot{\mathbf{x}}" />:</p>
<p><br /><img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%0A%5Cdot%7B%5Cmathbf%7Bx%7D%7D%20%3D%20%5Chat%7BJ%7D_f%20%5Cdot%7B%5Cmathbf%7Bq%7D%7D%0A" alt="
\dot{\mathbf{x}} = \hat{J}_f \dot{\mathbf{q}}
" title="
\dot{\mathbf{x}} = \hat{J}_f \dot{\mathbf{q}}
" /><br /></p>
<p>And we can plug it in (remembering that <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%28A%20B%29%5ET%20%3D%20B%5ET%20A%5ET" alt="(A B)^T = B^T A^T" title="(A B)^T = B^T A^T" />) to our kinetic energy equation to get:</p>
<p><br /><img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%0AKE%28%5Cmathbf%7Bq%7D%2C%5Cdot%7B%5Cmathbf%7Bq%7D%7D%29%20%3D%20%5Cfrac%7B1%7D%7B2%7D%20%5Cdot%7B%5Cmathbf%7Bq%7D%7D%5ET%20%5Chat%7BJ%7D_f%5ET%0A%20%20%20%20%5Chat%7BM%7D%20%5Chat%7BJ%7D_f%20%5Cdot%7B%5Cmathbf%7Bq%7D%7D%0A" alt="
KE(\mathbf{q},\dot{\mathbf{q}}) = \frac{1}{2} \dot{\mathbf{q}}^T \hat{J}_f^T
    \hat{M} \hat{J}_f \dot{\mathbf{q}}
" title="
KE(\mathbf{q},\dot{\mathbf{q}}) = \frac{1}{2} \dot{\mathbf{q}}^T \hat{J}_f^T
    \hat{M} \hat{J}_f \dot{\mathbf{q}}
" /><br /></p>
<p>And for the final step, we differentiate with respect to <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cdot%7B%5Cmathbf%7Bq%7D%7D" alt="\dot{\mathbf{q}}" title="\dot{\mathbf{q}}" /> to get <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cmathbf%7Bp%7D" alt="\mathbf{p}" title="\mathbf{p}" />, the vector of conjugate momenta:</p>
<p><br /><img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%0A%5Cmathbf%7Bp%7D%20%3D%20%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20%5Cdot%7B%5Cmathbf%7Bq%7D%7D%7D%20%5Cleft%5B%0A%20%20%20%20%5Cfrac%7B1%7D%7B2%7D%20%5Cdot%7B%5Cmathbf%7Bq%7D%7D%5ET%20%5Chat%7BJ%7D_f%5ET%20%5Chat%7BM%7D%20%5Chat%7BJ%7D_f%20%5Cdot%7B%5Cmathbf%7Bq%7D%7D%0A%20%20%5Cright%5D%0A%20%20%3D%20%5Chat%7BJ%7D_f%5ET%20%5Chat%7BM%7D%20%5Chat%7BJ%7D_f%20%5Cdot%7B%5Cmathbf%7Bq%7D%7D%0A" alt="
\mathbf{p} = \frac{\partial}{\partial \dot{\mathbf{q}}} \left[
    \frac{1}{2} \dot{\mathbf{q}}^T \hat{J}_f^T \hat{M} \hat{J}_f \dot{\mathbf{q}}
  \right]
  = \hat{J}_f^T \hat{M} \hat{J}_f \dot{\mathbf{q}}
" title="
\mathbf{p} = \frac{\partial}{\partial \dot{\mathbf{q}}} \left[
    \frac{1}{2} \dot{\mathbf{q}}^T \hat{J}_f^T \hat{M} \hat{J}_f \dot{\mathbf{q}}
  \right]
  = \hat{J}_f^T \hat{M} \hat{J}_f \dot{\mathbf{q}}
" /><br /></p>
<p>That’s it!<a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a> Writing it in matrix/vector form makes it easy for us to write programmatically, instead of doing indexing by hand – there are plenty of libraries that give us vector and matrix multiplication.</p>
<p>We’re going to be using <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Chat%7BJ%7D_f%5ET%20%5Chat%7BM%7D%20%5Chat%7BJ%7D_f" alt="\hat{J}_f^T \hat{M} \hat{J}_f" title="\hat{J}_f^T \hat{M} \hat{J}_f" /> a lot, so let’s give it a name, <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Chat%7BP%7D" alt="\hat{P}" title="\hat{P}" />. If the masses are all positive and <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Chat%7BJ%7D_f" alt="\hat{J}_f" title="\hat{J}_f" /> is full-rank, then <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Chat%7BP%7D" alt="\hat{P}" title="\hat{P}" /> is a symmetric, positive-definite, invertible matrix (by construction). It’s important to also remember that it’s an explicit function of <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cmathbf%7Bq%7D" alt="\mathbf{q}" title="\mathbf{q}" />, because <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Chat%7BJ%7D_f" alt="\hat{J}_f" title="\hat{J}_f" /> is a matrix of partial derivatives at a given <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cmathbf%7Bq%7D" alt="\mathbf{q}" title="\mathbf{q}" />. We now have a simple expression for the vector of conjugate momenta, then: <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cmathbf%7Bp%7D%20%3D%20%5Chat%7BP%7D%20%5Cdot%7B%5Cmathbf%7Bq%7D%7D" alt="\mathbf{p} = \hat{P} \dot{\mathbf{q}}" title="\mathbf{p} = \hat{P} \dot{\mathbf{q}}" /></p>
<p>Now, we’re going to see that it’s going to be important for us to also be able to go backwards (to get <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cdot%7B%5Cmathbf%7Bq%7D%7D" alt="\dot{\mathbf{q}}" title="\dot{\mathbf{q}}" /> from <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cmathbf%7Bp%7D" alt="\mathbf{p}" title="\mathbf{p}" />). Luckily, because we wrote the whole thing as a matrix operation, going backwards is easy – just take the matrix inverse, which we know exists!</p>
<p><br /><img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%0A%5Cdot%7B%5Cmathbf%7Bq%7D%7D%20%3D%20%5Chat%7BP%7D%5E%7B-1%7D%20%5Cmathbf%7Bp%7D%0A" alt="
\dot{\mathbf{q}} = \hat{P}^{-1} \mathbf{p}
" title="
\dot{\mathbf{q}} = \hat{P}^{-1} \mathbf{p}
" /><br /></p>
<p>The power of linear algebra!</p>
<h3 id="hamiltonians-of-physical-systems">Hamiltonians of Physical Systems</h3>
<p>Ok, that’s step one. How about step two – finding the Hamiltonian for your system?</p>
<p>The <em>real</em> Hamiltonian is actually the <a href="https://en.wikipedia.org/wiki/Poisson_bracket">Poisson bracket</a> of the system’s <a href="https://en.wikipedia.org/wiki/Lagrangian_mechanics">Lagrangian</a>, but I did some of the work for you can for the case of time-independent coordinates where the potential energy depends <em>only</em> on positions (so, no friction, wind resistance, etc.), the Hamiltonian of a system is precisely the system’s total <a href="https://en.wikipedia.org/wiki/Mechanical_energy">mechanical energy</a>, or its kinetic energy plus the potential energy:</p>
<p><br /><img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%0A%5Cmathcal%7BH%7D%28%5Cmathbf%7Bq%7D%2C%5Cmathbf%7Bp%7D%29%20%3D%20KE%28%5Cmathbf%7Bq%7D%2C%5Cmathbf%7Bp%7D%29%20%2B%20PE%28%5Cmathbf%7Bq%7D%29%0A" alt="
\mathcal{H}(\mathbf{q},\mathbf{p}) = KE(\mathbf{q},\mathbf{p}) + PE(\mathbf{q})
" title="
\mathcal{H}(\mathbf{q},\mathbf{p}) = KE(\mathbf{q},\mathbf{p}) + PE(\mathbf{q})
" /><br /></p>
<p>Which makes a lot of intuitive sense, because you might recall that total mechanical energy is always conserved for certain types of systems. Incidentally, Hamiltonian dynamics makes sure that the value of the system’s Hamiltonian stays the same (because it moves along contour lines). So, the system’s Hamiltonian always stays the same, and so its total mechanical energy stays the same, as well! Energy is conserved because the Hamiltonian stays the same!</p>
<p>Anyway, we want to build our system’s Hamiltonian from properties of the coordinate system, so plugging in our expression for <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?KE" alt="KE" title="KE" />:</p>
<p><br /><img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%0A%5Cmathcal%7BH%7D%28%5Cmathbf%7Bq%7D%2C%5Cdot%7B%5Cmathbf%7Bq%7D%7D%29%20%3D%20%5Cfrac%7B1%7D%7B2%7D%20%5Cdot%7B%5Cmathbf%7Bq%7D%7D%5ET%20%5Chat%7BP%7D%20%5Cdot%7B%5Cmathbf%7Bq%7D%7D%20%2B%20PE%28%5Cmathbf%7Bq%7D%29%0A" alt="
\mathcal{H}(\mathbf{q},\dot{\mathbf{q}}) = \frac{1}{2} \dot{\mathbf{q}}^T \hat{P} \dot{\mathbf{q}} + PE(\mathbf{q})
" title="
\mathcal{H}(\mathbf{q},\dot{\mathbf{q}}) = \frac{1}{2} \dot{\mathbf{q}}^T \hat{P} \dot{\mathbf{q}} + PE(\mathbf{q})
" /><br /></p>
<p>Oh, but oops, the Hamiltonian has to be a function of <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cmathbf%7Bp%7D" alt="\mathbf{p}" title="\mathbf{p}" />, not of <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cdot%7B%5Cmathbf%7Bq%7D%7D" alt="\dot{\mathbf{q}}" title="\dot{\mathbf{q}}" />. Let’s remember that <img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%5Cdot%7B%5Cmathbf%7Bq%7D%7D%20%3D%20%5Chat%7BP%7D%5E%7B-1%7D%20%5Cmathbf%7Bp%7D" alt="\dot{\mathbf{q}} = \hat{P}^{-1} \mathbf{p}" title="\dot{\mathbf{q}} = \hat{P}^{-1} \mathbf{p}" /> and find the final form of our Hamiltonian (after a bit of simplification):</p>
<p><br /><img style="vertical-align:middle" src="https://latex.codecogs.com/gif.latex?%0A%5Cmathcal%7BH%7D%28%5Cmathbf%7Bq%7D%2C%5Cmathbf%7Bp%7D%29%20%3D%20%5Cfrac%7B1%7D%7B2%7D%20%5Cmathbf%7Bp%7D%5ET%20%5Chat%7BP%7D%5E%7B-1%7D%20%5Cmathbf%7Bp%7D%20%2B%20PE%28%5Cmathbf%7Bq%7D%29%0A" alt="
\mathcal{H}(\mathbf{q},\mathbf{p}) = \frac{1}{2} \mathbf{p}^T \hat{P}^{-1} \mathbf{p} + PE(\mathbf{q})
" title="
\mathcal{H}(\mathbf{q},\mathbf{p}) = \frac{1}{2} \mathbf{p}^T \hat{P}^{-1} \mathbf{p} + PE(\mathbf{q})
" /><br /></p>
<section class="footnotes">
<hr />
<ol>
<li id="fn1"><p>The picture with a time-dependent Hamiltonian is different, but only slightly. In the time-dependent case, the system still <em>tries</em> to move along contour lines at every point in time, but the mountain is constantly changing underneath it and the contour lines keep on shifting underneath it. Sounds like life!<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>Disclaimer: I am not a surfer<a href="#fnref2">↩</a></p></li>
<li id="fn3"><p>Oh hey, maybe you’re upset because I just casually took a derivative with respect to a vector and didn’t justify what I meant. That’s cool, I’d be miffed too.<a href="#fnref3">↩</a></p></li>
</ol>
</section></div><footer><ul class="entry-series"></ul><ul class="tag-list"><li><a href="https://blog.jle.im/entries/tagged/dependent-types.html" class="tag-a-tag">#dependent types</a></li><li><a href="https://blog.jle.im/entries/tagged/functional-programming.html" class="tag-a-tag">#functional programming</a></li><li><a href="https://blog.jle.im/entries/tagged/haskell.html" class="tag-a-tag">#haskell</a></li><li><a href="https://blog.jle.im/entries/tagged/numerical-methods.html" class="tag-a-tag">#numerical methods</a></li><li><a href="https://blog.jle.im/entries/tagged/physics.html" class="tag-a-tag">#physics</a></li><li><a href="https://blog.jle.im/entries/category/@haskell.html" class="tag-a-category">@HASKELL</a></li></ul><aside class="social-buttons"><div class="addthis_toolbox addthis_default_style addthis-buttons"><a class="addthis_button_facebook_like" fb:like:layout="button_count"></a><a class="addthis_button_tweet"></a><a class="addthis_button_google_plusone" g:plusone:size="medium"></a><a class="addthis_counter addthis_pill_style"></a></div><div class="custom-social-buttons"><div class="custom-social-button"><a href="https://www.reddit.com/submit" onclick="window.location = &#39;https://www.reddit.com/submit?url=&#39;+ encodeURIComponent(window.location); return false"><img src="https://www.reddit.com/static/spreddit7.gif" alt="submit to reddit"></a></div></div></aside><nav class="next-prev-links"><ul><li class="next-entry-link">(Next) <a href="https://blog.jle.im/entry/introducing-in-code.html">Introducing “in Code”!</a> &rarr;</li></ul></nav></footer></article><div class="post-entry"><div class="tile"><div id="disqus_thread"></div><script type="text/javascript">var disqus_config = function () {
    this.page.url = 'https://blog.jle.im/entry/hamiltonian-dynamics-in-haskell.html';
    this.page.identifier = 'hamilton-1';
};
(function() {
    var d = document, s = d.createElement('script');
    s.src = '//incode.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a><br></noscript><a href="http://disqus.com" class="dsq-brlink">Comments powered by <span class="logo-disqus">Disqus</span></a></div></div></div></div></div><div id="footer-container"><div id="footer-content"><div class="tile"><div class="footer-copyright">&copy; 2016 Justin Le</div><div class="footer-follow social-follows"><ul class="social-follows-list"><li><ul class="social-follows-list-social"><li><a class="social-follow-twitter" title="Follow me on Twitter!" href="https://twitter.com/intent/user?user_id=mstk" onclick="window.open(
  &#39;http://twitter.com/intent/user?user_id=907281&#39;,
  &#39;facebook-share-dialog&#39;,
  &#39;width=550,height=520&#39;);
return false;
">Twitter</a></li><li><a class="social-follow-gplus" title="Add me on Google+!" href="https://plus.google.com/+JustinLe">Google+</a></li><li><a class="social-follow-linkedin" title="Connect with me on LinkedIn!" href="https://linkedin.com/in/lejustin">LinkedIn</a></li><li><a class="social-follow-github" title="Fork me on Github!" href="https://github.com/mstksg">Github</a></li><li><a class="social-follow-keybase" title="Track me on Keybase!" href="https://keybase.io/mstksg">Keybase</a></li><li><a class="social-follow-bitcoin" title="Donate via bitcoin!" href="https://coinbase.com/mstksg">Bitcoin</a></li></ul></li><li><ul class="social-follows-list-site"><li><a class="social-follow-rss" title="Subscribe to my RSS Feed!" href="http://feeds.feedburner.com/incodeblog">RSS</a></li><li><a class="social-follow-email" title="Subscribe to the mailing list!" href="https://feedburner.google.com/fb/a/mailverify?loc=en_US&amp;uri=incodeblog">Mailing list</a></li></ul></li></ul></div></div></div></div></body></html>